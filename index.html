<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Ø­Ø§Ø³Ø¨Ø© ÙƒÙˆØ¨ Ø§Ù„Ù‚Ù‡ÙˆØ©</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&family=Outfit:wght@500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: light;
      --bg: #faf4ec;
      --bg-2: #f3e4d3;
      --card: #ffffff;
      --card-soft: #fdf7f1;
      --text: #2f2115;
      --muted: #8a7360;
      --accent: #c4804b;
      --accent-soft: #f2c9a1;
      --accent-strong: #9a5422;
      --border: rgba(128, 94, 62, 0.16);
      --shadow-soft: 0 22px 50px rgba(131, 94, 64, 0.18);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Cairo", "Outfit", -apple-system, system-ui, "Helvetica Neue", Arial, sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(250, 230, 204, 0.8), transparent 60%),
        radial-gradient(circle at 90% 10%, rgba(218, 170, 120, 0.45), transparent 55%),
        radial-gradient(circle at 50% 90%, rgba(203, 156, 113, 0.35), transparent 55%),
        linear-gradient(160deg, var(--bg), var(--bg-2));
      color: var(--text);
      min-height: 100vh;
      padding: 18px 16px;
      display: flex;
      justify-content: center;
      transition: background 0.4s ease;
    }
    /* Ø«ÙŠÙ… Ø§Ù„Ù‚Ù‡ÙˆØ© Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©: Ø£Ù„ÙˆØ§Ù† Ø«Ù„Ø¬ ÙˆØ£Ø²Ø±Ù‚ ÙØ§ØªØ­ (ØªØ¹Ø¯ÙŠÙ„ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙƒØ§Ù…Ù„Ø©) */
    body.cold-mode {
      --bg: #e0f2fe;
      --bg-2: #eff6ff;
      --card: #f9fbff;
      --card-soft: #edf5ff;
      --text: #0f172a;
      --muted: #64748b;
      --accent: #2563eb;
      --accent-soft: #bfdbfe;
      --accent-strong: #1d4ed8;
      --border: rgba(148, 163, 184, 0.4);
      --shadow-soft: 0 22px 50px rgba(37, 99, 235, 0.25);

      background:
        radial-gradient(circle at 10% 0%, rgba(219, 242, 255, 0.9), transparent 60%),
        radial-gradient(circle at 90% 20%, rgba(147, 197, 253, 0.6), transparent 55%),
        radial-gradient(circle at 50% 95%, rgba(191, 219, 254, 0.55), transparent 55%),
        linear-gradient(165deg, #e0f2fe, #f5f3ff);
    }
    /* Dark Mode */
    body.dark-mode {
      --bg: #0a0810;
      --bg-2: #0f0d15;
      --card: #1a1620;
      --card-soft: #1f1b28;
      --text: #f5f3f7;
      --muted: #9d8fa8;
      --accent: #d4a574;
      --accent-soft: #b8936a;
      --accent-strong: #e8c99f;
      --border: rgba(157, 143, 168, 0.15);
      --shadow-soft: 0 22px 50px rgba(0, 0, 0, 0.6);

      background:
        radial-gradient(circle at 10% 0%, rgba(26, 22, 32, 0.9), transparent 60%),
        radial-gradient(circle at 90% 10%, rgba(31, 27, 40, 0.8), transparent 55%),
        radial-gradient(circle at 50% 90%, rgba(15, 13, 21, 0.7), transparent 55%),
        linear-gradient(160deg, var(--bg), var(--bg-2));
    }
    body.dark-mode.cold-mode {
      --bg: #0a0f1a;
      --bg-2: #0f1520;
      --card: #151b28;
      --card-soft: #1a2130;
      --text: #f0f4f8;
      --muted: #8b9db8;
      --accent: #60a5fa;
      --accent-soft: #3b82f6;
      --accent-strong: #93c5fd;
      --border: rgba(139, 157, 184, 0.2);
      --shadow-soft: 0 22px 50px rgba(0, 0, 0, 0.6);

      background:
        radial-gradient(circle at 10% 0%, rgba(21, 27, 40, 0.9), transparent 60%),
        radial-gradient(circle at 90% 20%, rgba(26, 33, 48, 0.8), transparent 55%),
        radial-gradient(circle at 50% 95%, rgba(15, 21, 32, 0.7), transparent 55%),
        linear-gradient(165deg, #0a0f1a, #0f1520);
    }
    /* Ø²Ø± Dark Mode */
    .dark-mode-toggle {
      position: fixed;
      top: 16px;
      left: 16px;
      z-index: 100;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 2px solid var(--border);
      background: var(--card);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.3rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
    }
    .dark-mode-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
    .dark-mode-toggle:active {
      transform: scale(0.95);
    }
    body.dark-mode .dark-mode-toggle {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    }

    .shell {
      width: min(460px, 100%);
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      color: var(--muted);
      font-size: 0.86rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .app-header span:first-child {
      font-weight: 700;
      color: var(--accent-strong);
    }

    .container {
      position: relative;
      background: radial-gradient(circle at top left, rgba(255,255,255,0.9), rgba(255,255,255,0.96));
      border: 1px solid var(--border);
      border-radius: 24px;
      padding: 18px 16px 22px;
      box-shadow: var(--shadow-soft);
      overflow: hidden;
    }
    body.cold-mode .container {
      background: radial-gradient(circle at top left, rgba(239,246,255,0.98), rgba(248,250,252,1));
    }
    body.dark-mode .container {
      background: radial-gradient(circle at top left, var(--card), var(--card-soft));
      border-color: var(--border);
    }

    .container::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at -10% 0%, rgba(242, 201, 161, 0.35), transparent 55%),
        radial-gradient(circle at 120% 0%, rgba(196, 128, 75, 0.25), transparent 55%);
      opacity: 0.6;
      pointer-events: none;
    }
    body.cold-mode .container::before {
      background:
        radial-gradient(circle at -10% 0%, rgba(191, 219, 254, 0.7), transparent 55%),
        radial-gradient(circle at 120% 0%, rgba(129, 212, 250, 0.45), transparent 55%);
    }
    body.dark-mode .container::before {
      opacity: 0.3;
      background:
        radial-gradient(circle at -10% 0%, rgba(212, 169, 116, 0.2), transparent 55%),
        radial-gradient(circle at 120% 0%, rgba(184, 147, 106, 0.15), transparent 55%);
    }
    body.dark-mode.cold-mode .container::before {
      background:
        radial-gradient(circle at -10% 0%, rgba(96, 165, 250, 0.2), transparent 55%),
        radial-gradient(circle at 120% 0%, rgba(59, 130, 246, 0.15), transparent 55%);
    }
    .content {
      position: relative;
      z-index: 1;
    }

    .hero {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
      margin-bottom: 14px;
    }
    .hero-main {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .hero-title {
      display: flex;
      align-items: baseline;
      gap: 6px;
    }
    h1 {
      margin: 0;
      font-size: 1.45rem;
      font-weight: 800;
      letter-spacing: -0.02em;
    }
    .hero-tag {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(247, 230, 209, 0.9);
      color: var(--accent-strong);
      font-size: 0.74rem;
      font-weight: 700;
    }
    body.cold-mode .hero-tag {
      background: rgba(219, 234, 254, 0.95);
      color: var(--accent-strong);
    }
    p.lead {
      margin: 0;
      color: var(--muted);
      font-size: 0.9rem;
      font-weight: 700;
    }
    .hero-illustration {
      width: 88px;
      height: 88px;
      border-radius: 26px;
      background:
        radial-gradient(circle at 30% 0%, #fff7ed, transparent 55%),
        radial-gradient(circle at 70% 100%, #fed7aa, transparent 55%),
        linear-gradient(145deg, #f97316, #9a3412);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      box-shadow:
        0 16px 40px rgba(148, 94, 54, 0.55),
        0 0 0 1px rgba(255, 255, 255, 0.6);
    }
    body.cold-mode .hero-illustration {
      background:
        radial-gradient(circle at 30% 0%, #eff6ff, transparent 55%),
        radial-gradient(circle at 70% 100%, #bfdbfe, transparent 55%),
        linear-gradient(145deg, #0ea5e9, #2563eb);
      box-shadow:
        0 16px 40px rgba(37, 99, 235, 0.5),
        0 0 0 1px rgba(239, 246, 255, 0.9);
    }
    .cup {
      width: 54px;
      height: 40px;
      border-radius: 16px 16px 20px 20px;
      background: #fefce8;
      position: relative;
      box-shadow:
        0 8px 16px rgba(124, 45, 18, 0.35),
        inset 0 0 0 1px rgba(250, 204, 170, 1);
    }
    body.cold-mode .cup {
      background: #e0f2fe;
      box-shadow:
        0 8px 16px rgba(37, 99, 235, 0.3),
        inset 0 0 0 1px rgba(191, 219, 254, 1);
    }
    .cup::before {
      content: "";
      position: absolute;
      inset: 7px 7px 14px;
      border-radius: 12px 12px 18px 18px;
      background: linear-gradient(180deg, #7c2d12, #431407);
    }
    body.cold-mode .cup::before {
      background: linear-gradient(180deg, #0c4a6e, #075985);
    }
    .cup::after {
      content: "";
      position: absolute;
      right: -10px;
      top: 12px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 3px solid #fed7aa;
      box-shadow: inset 0 0 0 2px #f97316;
      background: transparent;
    }
    body.cold-mode .cup::after {
      border-color: #bfdbfe;
      box-shadow: inset 0 0 0 2px #2563eb;
    }
    .steam {
      position: absolute;
      top: -10px;
      left: 16px;
      display: flex;
      gap: 5px;
    }
    body.cold-mode .steam {
      display: none;
    }
    .steam span {
      display: block;
      width: 4px;
      height: 16px;
      border-radius: 999px;
      background: linear-gradient(to top, rgba(248, 250, 252, 0), rgba(255, 255, 255, 0.95));
      opacity: 0.8;
      animation: steam 2.2s ease-in-out infinite;
    }
    .steam span:nth-child(2) { animation-delay: .3s; }
    .steam span:nth-child(3) { animation-delay: .6s; }

    @keyframes steam {
      0% { transform: translateY(6px); opacity: 0; }
      35% { opacity: 0.9; }
      100% { transform: translateY(-10px); opacity: 0; }
    }
    .ice-cubes {
      position: absolute;
      top: -8px;
      left: 12px;
      display: none;
      gap: 3px;
    }
    body.cold-mode .ice-cubes {
      display: flex;
    }
    .ice-cube {
      width: 6px;
      height: 6px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 2px;
      box-shadow: 0 1px 2px rgba(37, 99, 235, 0.3);
      animation: float 2s ease-in-out infinite;
    }
    .ice-cube:nth-child(1) { animation-delay: 0s; }
    .ice-cube:nth-child(2) { animation-delay: 0.4s; }
    .ice-cube:nth-child(3) { animation-delay: 0.8s; }
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.8; }
      50% { transform: translateY(-3px) rotate(5deg); opacity: 1; }
    }

    .section-title {
      margin: 0 0 6px;
      font-size: 1.1rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--muted);
    }

    .mode-toggle {
      display: inline-flex;
      padding: 5px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.95);
      border: 2px solid rgba(214, 158, 110, 0.4);
      box-shadow: 0 6px 20px rgba(148, 94, 54, 0.12);
      gap: 5px;
    }
    body.cold-mode .mode-toggle {
      background: rgba(239, 246, 255, 0.98);
      border-color: rgba(191, 219, 254, 0.6);
      box-shadow: 0 6px 20px rgba(37, 99, 235, 0.18);
    }
    body.dark-mode .mode-toggle {
      background: var(--card);
      border-color: var(--border);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    .mode-chip {
      border-radius: 999px;
      border: none;
      background: transparent;
      padding: 8px 16px;
      font-size: 0.9rem;
      cursor: pointer;
      color: var(--muted);
      font-weight: 700;
      transition: all 0.2s ease;
      position: relative;
    }
    .mode-chip:hover {
      background: rgba(196, 128, 75, 0.1);
      color: var(--accent);
    }
    .mode-chip.active {
      background: linear-gradient(145deg, #f97316, #ea580c);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(194, 120, 69, 0.4);
      transform: translateY(-1px);
    }
    body.cold-mode .mode-chip.active {
      background: linear-gradient(145deg, #2563eb, #1d4ed8);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
    }
    body.dark-mode .mode-chip:hover {
      background: rgba(196, 128, 75, 0.2);
      color: var(--accent-strong);
    }
    body.dark-mode .mode-chip.active {
      background: linear-gradient(145deg, #c4804b, #9a5422);
      box-shadow: 0 4px 12px rgba(196, 128, 75, 0.4);
    }
    body.dark-mode.cold-mode .mode-chip.active {
      background: linear-gradient(145deg, #3b82f6, #2563eb);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
    }
    .mode-chip:active {
      transform: translateY(0) scale(0.98);
    }
    .mode-chip.active:active {
      transform: translateY(0) scale(0.98);
    }
    /* Ø²Ø± ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² */
    .focus-mode-btn {
      border-radius: 999px;
      border: 2px solid var(--accent);
      background: linear-gradient(145deg, var(--accent), var(--accent-strong));
      color: #ffffff;
      padding: 8px 18px;
      font-size: 0.9rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 12px rgba(196, 128, 75, 0.3);
    }
    .focus-mode-btn:hover {
      background: linear-gradient(145deg, var(--accent-strong), var(--accent));
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(196, 128, 75, 0.4);
    }
    .focus-mode-btn:active {
      transform: translateY(0);
    }
    body.cold-mode .focus-mode-btn {
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }
    body.cold-mode .focus-mode-btn:hover {
      box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
    }
    body.dark-mode .focus-mode-btn {
      box-shadow: 0 4px 12px rgba(196, 128, 75, 0.4);
    }
    body.dark-mode .focus-mode-btn:hover {
      box-shadow: 0 6px 16px rgba(196, 128, 75, 0.5);
    }
    /* Popup ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² */
    .focus-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(6px);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn 0.3s ease;
    }
    .focus-overlay.active {
      display: flex;
    }
    .focus-popup {
      background: #ffffff;
      border-radius: 24px;
      padding: 24px;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      border: 2px solid #e5e7eb;
      position: relative;
      animation: slideUp 0.3s ease;
    }
    .focus-popup-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 14px;
      border-bottom: 2px solid #f3f4f6;
    }
    .focus-popup-title {
      font-size: 1.3rem;
      font-weight: 800;
      color: #111827;
      letter-spacing: -0.02em;
    }
    .focus-popup-close {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: none;
      background: #f3f4f6;
      color: #6b7280;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }
    .focus-popup-close:hover {
      background: #ef4444;
      color: #ffffff;
      transform: rotate(90deg);
    }
    .focus-popup-description {
      font-size: 0.88rem;
      color: #6b7280;
      text-align: center;
      margin: 0 0 20px 0;
      padding: 10px;
      background: #f9fafb;
      border-radius: 12px;
      line-height: 1.6;
      border: 1px solid #e5e7eb;
    }
    /* ØªØ¹Ø¯ÙŠÙ„ Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¯Ø§Ø®Ù„ ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² */
    .focus-popup .badge {
      background: #f3f4f6;
      color: #374151;
      border: 1px solid #e5e7eb;
    }
    .focus-popup .total {
      color: #111827;
    }
    .focus-popup .muted {
      color: #6b7280;
    }
    .focus-popup .pour {
      background: #ffffff;
      border-color: #e5e7eb;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }
    .focus-popup .pour:hover {
      background: #f9fafb;
      border-color: #d1d5db;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }
    .focus-popup .pour strong {
      color: #111827;
    }
    .focus-popup .pour span {
      background: #f3f4f6;
      color: #374151;
      border: 1px solid #e5e7eb;
    }
    .focus-popup .pour span .pour-label {
      color: #6b7280;
    }
    .focus-popup .pour span .pour-number {
      color: #111827;
    }
    .focus-popup .timer-container {
      background: #f9fafb;
      border-color: #e5e7eb;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }
    .focus-popup .timer-display {
      background: linear-gradient(145deg, #ffffff, #f9fafb);
      border-color: #d1d5db;
      box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.1),
        inset 0 1px 3px rgba(255, 255, 255, 0.9);
    }
    .focus-popup .timer-display.running {
      border-color: #3b82f6;
      box-shadow: 
        0 6px 18px rgba(59, 130, 246, 0.2),
        inset 0 1px 3px rgba(255, 255, 255, 0.9),
        0 0 15px rgba(59, 130, 246, 0.15);
    }
    .focus-popup .timer-time-text {
      color: #111827;
    }
    .focus-popup .timer-display.running .timer-time-text {
      color: #2563eb;
    }
    .focus-popup .timer-btn {
      background: #3b82f6;
      border: 1px solid #2563eb;
      color: #ffffff;
      box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
    }
    .focus-popup .timer-btn:hover {
      background: #2563eb;
      border-color: #1d4ed8;
      box-shadow: 0 6px 14px rgba(59, 130, 246, 0.4);
    }
    .focus-popup .timer-btn.stop {
      background: #ef4444;
      border-color: #dc2626;
      color: #ffffff;
    }
    .focus-popup .timer-btn.stop:hover {
      background: #dc2626;
      border-color: #b91c1c;
    }
    .focus-popup .timer-reset-btn {
      background: #f3f4f6;
      border: 1px solid #e5e7eb;
      color: #374151;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
    }
    .focus-popup .timer-reset-btn:hover {
      background: #e5e7eb;
      border-color: #d1d5db;
      color: #111827;
    }
    .focus-popup .timer-reset-btn.resume {
      background: #3b82f6;
      border-color: #2563eb;
      color: #ffffff;
    }
    .focus-popup .timer-reset-btn.resume:hover {
      background: #2563eb;
      border-color: #1d4ed8;
    }
    /* Dark Mode Ù„ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² */
    body.dark-mode .focus-popup {
      background: var(--card);
      border-color: var(--border);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
    }
    body.dark-mode .focus-popup-header {
      border-bottom-color: var(--border);
    }
    body.dark-mode .focus-popup-title {
      color: var(--text);
    }
    body.dark-mode .focus-popup-close {
      background: var(--card-soft);
      color: var(--muted);
    }
    body.dark-mode .focus-popup-close:hover {
      background: #ef4444;
      color: #ffffff;
    }
    body.dark-mode .focus-popup-description {
      background: var(--card-soft);
      color: var(--text);
      border-color: var(--border);
    }
    body.dark-mode .focus-popup .badge {
      background: var(--card-soft);
      color: var(--accent-strong);
      border-color: var(--border);
    }
    body.dark-mode .focus-popup .total {
      color: var(--text);
    }
    body.dark-mode .focus-popup .muted {
      color: var(--muted);
    }
    body.dark-mode .focus-popup .pour {
      background: var(--card);
      border-color: var(--border);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    }
    body.dark-mode .focus-popup .pour:hover {
      background: var(--card-soft);
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }
    body.dark-mode .focus-popup .pour strong {
      color: var(--text);
    }
    body.dark-mode .focus-popup .pour span {
      background: var(--card-soft);
      color: var(--accent-strong);
      border-color: var(--border);
    }
    body.dark-mode .focus-popup .pour span .pour-label {
      color: var(--muted);
    }
    body.dark-mode .focus-popup .pour span .pour-number {
      color: var(--accent-strong);
    }
    body.dark-mode .focus-popup .timer-container {
      background: var(--card-soft);
      border-color: var(--border);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    }
    body.dark-mode .focus-popup .timer-display {
      background: linear-gradient(145deg, var(--card), var(--card-soft));
      border-color: var(--accent);
      box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.5),
        inset 0 1px 3px rgba(0, 0, 0, 0.3);
    }
    body.dark-mode .focus-popup .timer-display.running {
      border-color: var(--accent);
      box-shadow: 
        0 6px 18px rgba(212, 169, 116, 0.4),
        inset 0 1px 3px rgba(0, 0, 0, 0.3),
        0 0 15px rgba(212, 169, 116, 0.3);
    }
    body.dark-mode .focus-popup .timer-time-text {
      color: var(--accent-strong);
    }
    body.dark-mode .focus-popup .timer-display.running .timer-time-text {
      color: var(--accent);
    }
    body.dark-mode .focus-popup .timer-btn {
      background: var(--accent);
      border-color: var(--accent-strong);
      color: #ffffff;
      box-shadow: 0 4px 10px rgba(212, 169, 116, 0.4);
    }
    body.dark-mode .focus-popup .timer-btn:hover {
      background: var(--accent-strong);
      border-color: var(--accent);
      box-shadow: 0 6px 14px rgba(212, 169, 116, 0.5);
    }
    body.dark-mode .focus-popup .timer-btn.stop {
      background: #ef4444;
      border-color: #dc2626;
      color: #ffffff;
    }
    body.dark-mode .focus-popup .timer-btn.stop:hover {
      background: #dc2626;
      border-color: #b91c1c;
    }
    body.dark-mode .focus-popup .timer-reset-btn {
      background: var(--card-soft);
      border-color: var(--border);
      color: var(--text);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }
    body.dark-mode .focus-popup .timer-reset-btn:hover {
      background: var(--card);
      border-color: var(--accent);
      color: var(--accent-strong);
    }
    body.dark-mode .focus-popup .timer-reset-btn.resume {
      background: var(--accent);
      border-color: var(--accent-strong);
      color: #ffffff;
    }
    body.dark-mode .focus-popup .timer-reset-btn.resume:hover {
      background: var(--accent-strong);
      border-color: var(--accent);
    }
    body.dark-mode.cold-mode .focus-popup .timer-display.running {
      border-color: var(--accent);
      box-shadow: 
        0 6px 18px rgba(96, 165, 250, 0.4),
        inset 0 1px 3px rgba(0, 0, 0, 0.3),
        0 0 15px rgba(96, 165, 250, 0.3);
    }
    body.dark-mode.cold-mode .focus-popup .timer-btn {
      background: var(--accent);
      border-color: var(--accent-strong);
      box-shadow: 0 4px 10px rgba(96, 165, 250, 0.4);
    }
    body.dark-mode.cold-mode .focus-popup .timer-btn:hover {
      box-shadow: 0 6px 14px rgba(96, 165, 250, 0.5);
    }
    body.dark-mode.cold-mode .focus-popup .timer-reset-btn.resume {
      background: var(--accent);
      border-color: var(--accent-strong);
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 18px;
      padding: 12px 12px 14px;
      border: 1px solid rgba(255, 255, 255, 0.8);
      box-shadow: 0 10px 25px rgba(148, 94, 54, 0.12);
    }
    body.cold-mode .card {
      background: rgba(239, 246, 255, 0.96);
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.18);
      border-color: rgba(219, 234, 254, 0.95);
    }
    body.dark-mode .card {
      background: var(--card);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      border-color: var(--border);
    }

    label {
      display: block;
      margin-bottom: 4px;
      font-weight: 600;
      color: var(--text);
      letter-spacing: -0.01em;
      font-size: 0.9rem;
    }
    .field { margin-bottom: 10px; }
    .input-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .input-step {
      border-radius: 999px;
      border: 1px solid rgba(148,94,54,0.22);
      background: #fdf4e7;
      color: var(--accent-strong);
      width: 30px;
      height: 30px;
      display: grid;
      place-items: center;
      font-size: 1rem;
      font-weight: 700;
      padding: 0;
      cursor: pointer;
      transition: background .15s, transform .1s, box-shadow .15s;
    }
    body.dark-mode .input-step {
      background: var(--card-soft);
      border-color: var(--border);
      color: var(--accent-strong);
    }
    .input-step:active {
      transform: translateY(1px) scale(0.97);
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.08);
    }
    input, select {
      width: 100%;
      background: var(--card-soft);
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 999px;
      padding: 10px 12px;
      font-size: 0.98rem;
      transition: border-color .2s, transform .12s, box-shadow .2s, background .2s;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      transform: translateY(-1px);
      background: #ffffff;
      box-shadow: 0 0 0 1px rgba(250, 250, 249, 0.9), 0 10px 22px rgba(193,128,75,0.25);
    }
    body.dark-mode input, body.dark-mode select {
      background: var(--card-soft);
      border-color: var(--border);
      color: var(--text);
    }
    body.dark-mode input:focus, body.dark-mode select:focus {
      background: var(--card);
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent), 0 10px 22px rgba(0, 0, 0, 0.5);
    }
    .inline {
      display: grid;
      grid-template-columns: 1.05fr 1fr;
      gap: 8px;
    }

    .output-card {
      margin-top: 14px;
      background: linear-gradient(145deg, #fefcf9, #fdf5ed);
      border-radius: 18px;
      padding: 14px 12px 15px;
      border: 1px solid rgba(250, 250, 249, 0.9);
      box-shadow: 0 14px 32px rgba(148, 94, 54, 0.18);
    }
    body.cold-mode .output-card {
      background: linear-gradient(145deg, #eff6ff, #e0f2fe);
      border-color: rgba(219, 234, 254, 0.95);
      box-shadow: 0 14px 32px rgba(59, 130, 246, 0.24);
    }
    body.dark-mode .output-card {
      background: linear-gradient(145deg, var(--card), var(--card-soft));
      border-color: var(--border);
      box-shadow: 0 14px 32px rgba(0, 0, 0, 0.4);
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      background: rgba(247, 230, 209, .9);
      color: var(--accent-strong);
      border-radius: 999px;
      font-weight: 700;
      font-size: 0.82rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }
    body.cold-mode .badge {
      background: rgba(219, 234, 254, 0.95);
      color: #1d4ed8;
    }
    body.dark-mode .badge {
      background: var(--card-soft);
      color: var(--accent-strong);
      border: 1px solid var(--border);
    }
    .badge::before {
      content: "â˜•";
      font-size: 0.95rem;
    }
    .total {
      font-size: 1.7rem;
      font-weight: 800;
      margin: 8px 0 2px;
      transition: transform .18s ease-out;
    }
    .total.bump { transform: scale(1.05); }
    .muted {
      color: var(--muted);
      font-size: 0.9rem;
    }
    .pours {
      margin: 12px 0 0;
      display: grid;
      gap: 8px;
    }
    .pour {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #fefaf6;
      border-radius: 14px;
      padding: 9px 10px;
      border: 1px solid rgba(244, 224, 206, 0.9);
      box-shadow: 0 7px 18px rgba(148, 94, 54, 0.15);
      transition: transform .15s ease-out, box-shadow .15s ease-out, background .15s ease-out;
    }
    body.cold-mode .pour {
      background: #eff6ff;
      border-color: rgba(191, 219, 254, 0.95);
      box-shadow: 0 7px 18px rgba(59, 130, 246, 0.18);
    }
    body.dark-mode .pour {
      background: var(--card);
      border-color: var(--border);
      box-shadow: 0 7px 18px rgba(0, 0, 0, 0.4);
    }
    body.dark-mode.cold-mode .pour {
      background: var(--card);
      border-color: var(--border);
      box-shadow: 0 7px 18px rgba(0, 0, 0, 0.4);
    }
    .pour:hover {
      transform: translateY(-1px);
      background: #fffaf5;
      box-shadow: 0 12px 24px rgba(148, 94, 54, 0.22);
    }
    body.cold-mode .pour:hover {
      background: #e0f2fe;
      box-shadow: 0 12px 24px rgba(37, 99, 235, 0.28);
    }
    /* Dark Mode Styles */
    body.dark-mode .pour:hover {
      background: var(--card-soft);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.5);
      border-color: var(--accent);
    }
    body.dark-mode .pour span {
      background: var(--card-soft);
      color: var(--accent-strong);
      border: 1px solid var(--border);
    }
    body.dark-mode .hint {
      background: var(--card);
      border-color: var(--border);
      color: var(--muted);
      border-style: dashed;
    }
    body.dark-mode.cold-mode .pour:hover {
      background: var(--card-soft);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4);
    }
    .pour strong { font-size: 0.95rem; }
    .pour span {
      background: rgba(250, 250, 249, 0.95);
      color: var(--accent-strong);
      padding: 6px 9px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 0.9rem;
      min-width: 70px;
      text-align: center;
    }
    .pour span .pour-label {
      color: var(--muted);
      font-weight: 500;
      font-size: 0.75rem;
      margin-left: 4px;
    }
    .pour span .pour-number {
      font-size: 1.05rem;
      font-weight: 800;
      color: var(--accent-strong);
    }
    .hint {
      margin-top: 10px;
      background: rgba(255,255,255,0.85);
      border-radius: 14px;
      padding: 9px 10px;
      border: 1px dashed rgba(214, 158, 110, 0.7);
      color: var(--muted);
      font-size: 0.86rem;
      line-height: 1.5;
    }
    /* Ø£Ù†Ù…Ø§Ø· ØµÙØ­Ø© "Ø¹Ø§Ù„Ø¬ ÙƒÙˆØ¨Ùƒ" */
    .fix-choices {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }
    .fix-chip {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(248, 250, 252, 0.9);
      padding: 6px 10px;
      font-size: 0.82rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      color: var(--text);
      transition: background .15s, transform .1s, box-shadow .15s, border-color .15s;
    }
    .fix-chip span {
      font-size: 0.9rem;
      font-weight: 600;
    }
    .fix-chip.active {
      background: var(--accent);
      color: #f9fafb;
      border-color: var(--accent-strong);
      box-shadow: 0 8px 18px var(--shadow-soft);
    }
    .fix-chip:active {
      transform: translateY(1px) scale(0.97);
    }
    body.dark-mode .fix-chip {
      background: var(--card-soft);
      border-color: var(--border);
      color: var(--text);
    }
    body.dark-mode .fix-chip.active {
      background: var(--accent);
      color: #ffffff;
      border-color: var(--accent-strong);
    }
    .fix-step {
      margin-top: 10px;
      padding: 10px 11px;
      border-radius: 14px;
      background: var(--card-soft);
      border: 1px solid var(--border);
      font-size: 0.9rem;
      line-height: 1.6;
    }
    .fix-step-title {
      font-weight: 700;
      margin-bottom: 4px;
      color: var(--accent-strong);
      font-size: 0.9rem;
    }
    .fix-actions {
      margin-top: 8px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      font-size: 0.8rem;
    }
    .fix-btn {
      flex: 1;
      border-radius: 999px;
      border: none;
      padding: 7px 10px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 600;
      transition: background .15s, transform .1s, box-shadow .15s;
    }
    .fix-btn-next {
      background: var(--accent);
      color: #f9fafb;
      box-shadow: 0 8px 16px rgba(0,0,0,0.15);
    }
    .fix-btn-reset {
      background: rgba(148,163,184,0.12);
      color: var(--muted);
    }
    .fix-btn:active {
      transform: translateY(1px) scale(0.97);
    }
    body.dark-mode .fix-btn-reset {
      background: var(--card-soft);
      color: var(--muted);
      border: 1px solid var(--border);
    }
    footer {
      text-align: center;
      margin-top: 0;
      color: var(--muted);
      font-size: 0.8rem;
      font-weight: 700;
      line-height: 1.4;
    }
    body.dark-mode footer a {
      background: var(--card-soft) !important;
      color: var(--accent-strong) !important;
    }
    body.dark-mode footer a:hover {
      background: var(--card) !important;
      color: var(--accent) !important;
    }
    /* Ø£Ù†Ù…Ø§Ø· Ù‚Ø³Ù… Ø§Ù„Ø·Ø­Ù†Ø© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ */
    #grindResult {
      animation: fadeInUp 0.4s ease-out;
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(8px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    body.cold-mode #grindResult {
      background: linear-gradient(145deg, rgba(219,234,254,0.6), rgba(191,219,254,0.4)) !important;
      border-color: rgba(37,99,235,0.3) !important;
    }
    /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø¤Ù‚Øª */
    .timer-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 14px;
      border: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(148, 94, 54, 0.08);
    }
    body.cold-mode .timer-container {
      background: rgba(239, 246, 255, 0.98);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.12);
    }
    body.dark-mode .timer-container {
      background: var(--card);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    .timer-title {
      font-size: 0.9rem;
      color: var(--muted);
      font-weight: 600;
      text-align: center;
      margin-bottom: 4px;
    }
    .timer-display {
      width: 120px;
      height: 120px;
      margin: 0 auto;
      position: relative;
      border-radius: 50%;
      background: linear-gradient(145deg, #ffffff, #fef7f0);
      border: 3px solid var(--accent);
      box-shadow: 
        0 4px 12px rgba(148, 94, 54, 0.15),
        inset 0 2px 4px rgba(255, 255, 255, 0.9);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .timer-time-text {
      font-size: 1.5rem;
      font-weight: 800;
      color: var(--accent-strong);
      font-variant-numeric: tabular-nums;
      text-align: center;
    }
    .timer-display.running .timer-time-text {
      color: var(--accent);
    }
    .timer-display.finished .timer-time-text {
      color: #dc2626;
    }
    body.cold-mode .timer-display {
      background: linear-gradient(145deg, #ffffff, #eff6ff);
      box-shadow: 
        0 4px 12px rgba(37, 99, 235, 0.18),
        inset 0 2px 4px rgba(255, 255, 255, 0.9);
    }
    body.dark-mode .timer-display {
      background: linear-gradient(145deg, var(--card), var(--card-soft));
      box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.3),
        inset 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    .timer-display.running {
      border-color: var(--accent);
      animation: pulseTimer 2s ease-in-out infinite;
      box-shadow: 
        0 6px 18px rgba(196, 128, 75, 0.25),
        inset 0 2px 4px rgba(255, 255, 255, 0.9),
        0 0 15px rgba(196, 128, 75, 0.15);
    }
    body.cold-mode .timer-display.running {
      box-shadow: 
        0 6px 18px rgba(37, 99, 235, 0.3),
        inset 0 2px 4px rgba(255, 255, 255, 0.9),
        0 0 15px rgba(37, 99, 235, 0.2);
    }
    body.dark-mode .timer-display.running {
      box-shadow: 
        0 6px 18px rgba(196, 128, 75, 0.4),
        inset 0 2px 4px rgba(0, 0, 0, 0.2),
        0 0 15px rgba(196, 128, 75, 0.3);
    }
    body.dark-mode.cold-mode .timer-display.running {
      box-shadow: 
        0 6px 18px rgba(59, 130, 246, 0.4),
        inset 0 2px 4px rgba(0, 0, 0, 0.2),
        0 0 15px rgba(59, 130, 246, 0.3);
    }
    .timer-display.finished {
      border-color: #dc2626;
      animation: shake 0.5s ease-in-out;
      box-shadow: 
        0 6px 18px rgba(220, 38, 38, 0.25),
        inset 0 2px 4px rgba(255, 255, 255, 0.9);
    }
    @keyframes pulseTimer {
      0%, 100% { 
        transform: scale(1);
        opacity: 1;
      }
      50% { 
        transform: scale(1.02);
        opacity: 0.9;
      }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0) rotate(0deg); }
      25% { transform: translateX(-6px) rotate(-2deg); }
      75% { transform: translateX(6px) rotate(2deg); }
    }
    .timer-controls-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .timer-mode-toggle {
      display: flex;
      align-items: center;
      gap: 4px;
      background: var(--card-soft);
      padding: 4px;
      border-radius: 10px;
      border: 1px solid var(--border);
    }
    body.cold-mode .timer-mode-toggle {
      background: rgba(239, 246, 255, 0.9);
    }
    .timer-mode-btn {
      border: none;
      background: transparent;
      color: var(--muted);
      padding: 6px 10px;
      font-size: 0.8rem;
      font-weight: 700;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.2s ease;
      white-space: nowrap;
    }
    .timer-mode-btn:hover {
      background: rgba(196, 128, 75, 0.1);
      color: var(--accent);
    }
    .timer-mode-btn.active {
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 2px 6px rgba(196, 128, 75, 0.2);
    }
    body.cold-mode .timer-mode-btn.active {
      box-shadow: 0 2px 6px rgba(37, 99, 235, 0.25);
    }
    .timer-mode-btn:active {
      transform: scale(0.97);
    }
    .timer-input-group {
      display: flex;
      align-items: center;
      gap: 4px;
      background: var(--card-soft);
      padding: 6px 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
    }
    body.cold-mode .timer-input-group {
      background: rgba(239, 246, 255, 0.9);
    }
    .timer-input {
      width: 45px;
      background: transparent;
      border: none;
      color: var(--text);
      font-size: 0.95rem;
      font-weight: 700;
      text-align: center;
      padding: 0;
    }
    .timer-input:focus {
      outline: none;
    }
    .timer-label {
      font-size: 0.8rem;
      color: var(--muted);
      font-weight: 600;
    }
    .timer-btn {
      flex: 1;
      border-radius: 12px;
      border: none;
      background: var(--accent);
      color: #ffffff;
      padding: 10px;
      font-size: 0.95rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
      min-height: 44px;
      box-shadow: 0 4px 10px rgba(196, 128, 75, 0.25);
      user-select: none;
      -webkit-user-select: none;
      position: relative;
      z-index: 1;
    }
    .timer-reset-btn {
      background: rgba(148, 163, 184, 0.2);
      color: var(--muted);
      box-shadow: 0 4px 10px rgba(148, 163, 184, 0.15);
    }
    .timer-reset-btn:hover {
      background: rgba(148, 163, 184, 0.3);
      color: var(--text);
      box-shadow: 0 6px 14px rgba(148, 163, 184, 0.2);
    }
    .timer-reset-btn.resume {
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 4px 10px rgba(196, 128, 75, 0.25);
    }
    .timer-reset-btn.resume:hover {
      background: var(--accent-strong);
      box-shadow: 0 6px 14px rgba(196, 128, 75, 0.35);
    }
    .timer-btn * {
      pointer-events: none;
      user-select: none;
      -webkit-user-select: none;
    }
    .timer-btn:hover {
      background: var(--accent-strong);
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(196, 128, 75, 0.35);
    }
    .timer-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 6px rgba(196, 128, 75, 0.25);
    }
    .timer-btn.stop {
      background: #dc2626;
      box-shadow: 0 4px 10px rgba(220, 38, 38, 0.25);
    }
    .timer-btn.stop:hover {
      background: #b91c1c;
      box-shadow: 0 6px 14px rgba(220, 38, 38, 0.35);
    }
    body.cold-mode .timer-btn {
      box-shadow: 0 4px 10px rgba(37, 99, 235, 0.25);
    }
    body.cold-mode .timer-btn:hover {
      box-shadow: 0 6px 14px rgba(37, 99, 235, 0.35);
    }
    body.dark-mode .timer-btn {
      box-shadow: 0 4px 10px rgba(196, 128, 75, 0.4);
    }
    body.dark-mode .timer-btn:hover {
      box-shadow: 0 6px 14px rgba(196, 128, 75, 0.5);
    }
    body.dark-mode .timer-reset-btn {
      background: var(--card-soft);
      color: var(--muted);
      border: 1px solid var(--border);
    }
    body.dark-mode .timer-reset-btn:hover {
      background: var(--card);
      color: var(--text);
    }
    body.dark-mode .timer-reset-btn.resume {
      box-shadow: 0 4px 10px rgba(196, 128, 75, 0.4);
    }
    body.dark-mode .timer-reset-btn.resume:hover {
      box-shadow: 0 6px 14px rgba(196, 128, 75, 0.5);
    }
  </style>
</head>
<body>
  <button class="dark-mode-toggle" id="darkModeToggle" aria-label="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ">
    <span id="darkModeIcon">ğŸŒ™</span>
  </button>
  <main class="shell">
    <header class="app-header" aria-hidden="true"></header>

    <section class="container">
      <div class="content">
        <div class="hero">
          <div class="hero-main">
            <div class="hero-title">
              <h1>Ø­Ø§Ø³Ø¨Ø© ÙƒÙˆØ¨ Ø§Ù„Ù‚Ù‡ÙˆØ©</h1>
            </div>
            <p class="lead">Ù„Ùˆ Ù…Ø§ ÙƒÙ†Øª ØªÙ†Ø§Ù… Ø¨Ø­ØµØ© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ù‡Ù„ ÙƒÙ†Øª Ø¨ØªØ­ØªØ§Ø¬ Ù‡Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ</p>
          </div>
          <div class="hero-illustration" aria-hidden="true">
            <div class="cup">
              <div class="steam">
                <span></span><span></span><span></span>
              </div>
              <div class="ice-cubes">
                <span class="ice-cube"></span>
                <span class="ice-cube"></span>
                <span class="ice-cube"></span>
              </div>
            </div>
          </div>
        </div>

        <div style="display:flex; justify-content:center; align-items:center; gap:10px; margin-bottom:12px; flex-wrap:wrap;">
        <div class="mode-toggle" id="brewModeToggle">
          <button type="button" class="mode-chip active" data-mode="hot" data-view="brew">Ø§Ù„Ù‚Ù‡ÙˆØ© Ø§Ù„Ø­Ø§Ø±Ø©</button>
          <button type="button" class="mode-chip" data-mode="cold" data-view="brew">Ø§Ù„Ù‚Ù‡ÙˆØ© Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©</button>
          </div>
          <button type="button" class="focus-mode-btn" id="focusModeBtn">ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ²</button>
        </div>

        <!-- ØµÙØ­Ø© Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ù‡ÙˆØ© (Ø§Ù„Ø­Ø§Ø±Ø© / Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©) -->
        <div id="brew-view">
          <p class="section-title">Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª</p>
          <div class="card">
            <div class="field">
              <label for="coffee">ÙƒÙ…ÙŠØ© Ø§Ù„Ø¨Ù† (Ø¬Ø±Ø§Ù…)</label>
              <div class="input-row">
                <button type="button" class="input-step" data-step="-1">âˆ’</button>
                <input id="coffee" type="number" min="1" step="1" value="20" inputmode="numeric" placeholder="Ù…Ø«Ø§Ù„: 20">
                <button type="button" class="input-step" data-step="1">+</button>
              </div>
            </div>

            <div class="field inline">
              <div>
                <label for="ratio">Ø§Ù„Ø±ÙŠØ´ÙŠÙˆ</label>
                <select id="ratio">
                  <option value="7">1 / 7</option>
                  <option value="8">1 / 8</option>
                  <option value="10">1 / 10</option>
                  <option value="12">1 / 12</option>
                  <option value="15" selected>1 / 15</option>
                  <option value="16">1 / 16</option>
                  <option value="17">1 / 17</option>
                  <option value="18">1 / 18</option>
                  <option value="custom">Ù…Ø®ØµØµ</option>
                </select>
                <div id="ratioInfo" class="muted" style="font-size:0.82rem;margin-top:4px;"></div>
              </div>
              <div id="custom-wrapper" style="display:none">
                <label for="customRatio">Ø±ÙŠØ´ÙŠÙˆ Ù…Ø®ØµØµ</label>
                <input id="customRatio" type="number" min="7" max="25" step="0.1" value="15.0" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 15.0">
              </div>
            </div>
          </div>

          <p class="section-title" style="margin-top:14px;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙˆØ¨ ÙˆØ§Ù„ØµØ¨Ø§Øª:</p>
          <div class="output-card">
            <span class="badge">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
            <div class="total" id="totalWater">-- Ù…Ù„</div>
            <div class="muted" id="summary"></div>
            <div class="muted" id="coldLine" style="font-size:0.85rem;margin-top:4px;display:none;"></div>

            <div class="pours" id="pours"></div>
            <div style="margin-top:14px; padding-top:12px; border-top:1px solid var(--border);">
              <p style="margin:0; font-weight:700; font-size:0.85rem; color:#d82929; line-height:1.5; text-align:center;">
                Ø§Ø±Ø¬Ø¹ ØµØ¨ Ø§Ù„Ù…Ø§Ø¡ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø© Ø¨Ø¹Ø¯ Ù…Ø§ ØªØ´ÙˆÙ Ø³Ø·Ø­ Ø§Ù„Ù‚Ù‡ÙˆØ©
              </p>
            </div>
            <div class="timer-container" style="margin-top: 14px;">
              <div class="timer-title">Ù…Ø¤Ù‚Øª (Ù„Ùˆ ØªØ­ØªØ§Ø¬Ù‡)</div>
              <div class="timer-display" id="timerDisplay">
                <div class="timer-time-text" id="timerTimeText">00:00</div>
              </div>
              <div class="timer-controls-row">
                <button type="button" class="timer-btn" id="timerBtn">Ø§Ø¨Ø¯Ø£</button>
                <button type="button" class="timer-btn timer-reset-btn" id="timerResetBtn">Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Ù‚Ø³Ù… Ø¹Ø§Ù„Ø¬ ÙƒÙˆØ¨Ùƒ Ù…Ù†ÙØµÙ„ -->
    <section class="container" style="margin-top:10px;">
      <div class="content">
        <p class="section-title">Ø¹Ø§Ù„Ø¬ ÙƒÙˆØ¨Ùƒ</p>
        <div class="card">
          <p class="lead" style="font-size:0.92rem; margin-bottom:6px;">
            ÙƒÙŠÙ Ø·Ø¹Ù… Ø§Ù„ÙƒÙˆØ¨ Ù…Ø¹ÙƒØŸ
          </p>
          <div class="fix-choices" id="fixChoices">
            <button type="button" class="fix-chip" data-issue="bitter"><span>Ù…Ø±Ø§Ø±Ø© Ø¹Ø§Ù„ÙŠØ©</span></button>
            <button type="button" class="fix-chip" data-issue="acidic"><span>Ø­Ù…Ø¶ÙŠØ© Ø¹Ø§Ù„ÙŠØ©</span></button>
            <button type="button" class="fix-chip" data-issue="cold"><span>Ø§Ù„ÙƒÙˆØ¨ Ø¨Ø§Ø±Ø¯</span></button>
            <button type="button" class="fix-chip" data-issue="thin"><span>Ø§Ù„Ù‚ÙˆØ§Ù… Ø®ÙÙŠÙ</span></button>
            <button type="button" class="fix-chip" data-issue="burnt"><span>Ø·Ø¹Ù… Ø­Ø±Ù‚</span></button>
          </div>

          <div class="fix-step" id="fixStepBox" style="display:none;">
            <div class="fix-step-title" id="fixStepTitle"></div>
            <div class="muted" id="fixStepText"></div>
            <div class="fix-actions">
              <button type="button" class="fix-btn fix-btn-reset" id="fixReset">ØªÙ…Ø§Ù…</button>
              <button type="button" class="fix-btn fix-btn-next" id="fixNext">Ù…Ø§ Ø²Ø¨Ø·ØªØŒ ÙˆØ´ Ø£Ø³ÙˆÙŠØŸ</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ø·Ø­Ù†Ø© ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø© -->
    <section class="container" style="margin-top:10px;">
      <div class="content">
        <p class="section-title">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø·Ø­Ù†</p>
        <p style="font-size:0.82rem; color:var(--muted); line-height:1.6; margin:0 0 12px 0; padding-right:4px;">
          Ù…Ø§ÙÙŠ Ø£Ø­Ø¯ Ø¨ÙŠÙ‚Ø¯Ø± ÙŠØ¹Ø·ÙŠÙƒ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø·Ø­Ù† Ø§Ù„Ø£ÙƒÙŠØ¯Ø© Ø¥Ù„Ø§ Ù„Ùˆ Ø¹Ù†Ø¯Ù‡ Ù†ÙØ³ Ù…Ø·Ø­Ù†ØªÙƒ ÙˆÙ‚Ù‡ÙˆØªÙƒ ÙˆØ­ØªÙ‰ Ù†ÙØ³ ØªØ§Ø±ÙŠØ® Ø­Ù…ØµØªÙ‡Ø§.. Ø§Ù„Ø´ØºÙ„Ø© ÙƒÙ„Ù‡Ø§ (Ø¨ÙŠÙ† Ø§Ù„Ø¨ÙŠÙ†)ØŒ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… ÙŠØ³Ø§Ø¹Ø¯Ùƒ ÙÙ‚Ø· Ø¨Ø´ÙƒÙ„ ØªÙ‚Ø±ÙŠØ¨ÙŠØŒ ÙˆÙŠÙˆÙØ± Ø¹Ù„ÙŠÙƒ Ù‡Ø¯Ø±
        </p>
        <div class="card" id="grind-notes">
          <div class="field">
            <label for="coffeeType">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù‚Ù‡ÙˆØ©</label>
            <select id="coffeeType">
              <option value="">-- Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù‚Ù‡ÙˆØ© --</option>
              <option value="sumatra">Ø³ÙˆÙ…Ø·Ø±Ø©</option>
              <option value="salvador">Ø³Ù„ÙØ§Ø¯ÙˆØ±</option>
              <option value="honduras">Ù‡Ù†Ø¯ÙˆØ±Ø§Ø³</option>
              <option value="colombia">ÙƒÙˆÙ„ÙˆÙ…Ø¨ÙŠØ§</option>
              <option value="mexico">Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ</option>
              <option value="guatemala">ØºÙˆØ§ØªÙŠÙ…Ø§Ù„Ø§</option>
              <option value="costa-rica">ÙƒÙˆØ³ØªØ§Ø±ÙŠÙƒØ§</option>
              <option value="nicaragua">Ù†ÙŠÙƒØ§Ø±Ø§ØºÙˆØ§</option>
              <option value="panama">Ø¨Ù†Ù…Ø§</option>
              <option value="peru">Ø¨ÙŠØ±Ùˆ</option>
              <option value="ethiopia">Ø£Ø«ÙŠÙˆØ¨ÙŠØ§</option>
              <option value="yemen">Ø§Ù„ÙŠÙ…Ù†</option>
              <option value="rwanda">Ø±Ø§ÙˆÙ†Ø¯Ø§</option>
              <option value="uganda">Ø£ÙˆØºÙ†Ø¯Ø§</option>
              <option value="burundi">Ø¨ÙˆØ±Ù†Ø¯ÙŠ</option>
              <option value="brazil">Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„</option>
              <option value="kenya">ÙƒÙŠÙ†ÙŠØ§</option>
            </select>
          </div>
          <div id="grindResult" style="display:none; margin-top:12px; padding:12px; background:linear-gradient(145deg, rgba(247,230,209,0.6), rgba(242,201,161,0.4)); border-radius:14px; border:1px solid rgba(196,128,75,0.3);">
            <div style="display:flex; align-items:center; gap:8px; margin-bottom:6px;">
              <span style="font-size:1.2rem;">â˜•</span>
              <strong style="color:var(--accent-strong); font-size:0.95rem;">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø·Ø­Ù†Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©:</strong>
            </div>
            <div id="grindLevel" style="font-size:1.1rem; font-weight:700; color:var(--accent-strong); margin-top:4px;"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Ù‚Ø³Ù… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø© -->
    <section class="container" style="margin-top:10px;">
      <div class="content">
        <p class="section-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø©</p>
        <div class="card" id="quick-notes">
          <p class="lead" style="font-size:0.92rem; margin-bottom:6px;">
          </p>
          <ul class="muted" style="margin:0; padding-right:18px; font-size:0.88rem; line-height:1.7;">
            <li>Ø£ÙØ¶Ù„ Ù…Ø§Ø¡ ØªØ³ØªØ®Ø¯Ù…Ù‡ Ù„Ù„ØªØ±Ø´ÙŠØ­: Ù†ÙˆÙØ§ - ØªØ§Ù†ÙŠØ§.</li>
            <li>Ø£ÙØ¶Ù„ ÙÙ„Ø§ØªØ±: Ù…Ù† Ø´Ø±ÙƒØ© ÙƒØ§ÙÙŠÙƒ.</li>
            <li>Ø¬Ø±Ø¨ ØªØ«Ø¨Øª Ø¹Ù„Ù‰ ÙˆØµÙØ© ÙˆØ§Ø­Ø¯Ø© ÙˆØªÙ‚Ù„Ù„ ØªØºÙŠÙŠØ± Ø§Ù„Ø¹ÙˆØ§Ù…Ù„ØŒ ÙˆØ¨Ø¹Ø¯ÙŠÙ† Ø·ÙˆÙ‘Ø± Ù…Ù†Ù‡Ø§.</li>
            <li>Ø­Ø§ÙˆÙ„ ØªØµØ¨ Ø¨Ø«Ø¨Ø§ØªØŒ ÙˆØ¨Ù†Ø²ÙˆÙ„ Ø¹Ù†Ø¯ Ø³Ø·Ø­ Ø§Ù„Ù‚Ù‡ÙˆØ©.</li>
            <li>Ù„Ø§ ØªØ­ÙƒÙ… Ø¹Ù„Ù‰ Ù‚Ù‡ÙˆØªÙƒ Ù…Ù† Ø£ÙˆÙ„ Ø£Ùˆ Ø«Ø§Ù†ÙŠ ÙƒÙˆØ¨ØŒ ÙŠØ§Ø®ÙŠ Ø§ØµØ¨Ø±.</li>


          </ul>
        </div>
      </div>
    </section>

    <!-- Popup ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² -->
    <div class="focus-overlay" id="focusOverlay">
      <div class="focus-popup">
        <div class="focus-popup-header">
          <h2 class="focus-popup-title">ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ²</h2>
          <button type="button" class="focus-popup-close" id="focusCloseBtn">Ã—</button>
        </div>
        <p class="focus-popup-description">Ù‡Ø°Ø§ Ø§Ù„ÙˆØ¶Ø¹ ÙŠØ³Ø§Ø¹Ø¯Ùƒ Ø¹Ù„Ù‰ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ø¶ÙŠØ±ØŒ Ø¨Ø¯ÙˆÙ† Ø¨Ø§Ù‚ÙŠ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØµÙØ­Ø©</p>
        <div id="focusContent">
          <!-- Ø³ÙŠØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‡Ù†Ø§ -->
        </div>
      </div>
    </div>

    <footer style="text-align:center; font-size:1.2rem; margin-bottom:0;">â™¥ï¸</footer>
    <footer style="margin-top:0;">Ø§Ù„ÙƒÙˆØ¨ Ø§Ù„Ù„ÙŠ ÙŠØ±ÙˆÙ‚Ùƒ</footer>
    <footer style="margin-top:0;">Ù‡Ø¯ÙŠØ© Ù…Ù† Ø£Ø­Ù…Ø¯ Ø³Ù„ÙŠÙ…Ø§Ù† Ù„Ùƒ</footer>
    <footer style="margin-top:8px;">
      <div style="margin-bottom:8px; font-size:0.9rem; font-weight:600; color:var(--text);">ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙŠ Ù„Ùˆ Ø¹Ù†Ø¯Ùƒ Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ùˆ Ø§Ø³ØªÙØ³Ø§Ø±:</div>
      <div style="display:flex; justify-content:center; gap:12px; flex-wrap:wrap;">
        <a href="https://t.me/iAhmadH" target="_blank" rel="noopener noreferrer" style="display:inline-flex; align-items:center; gap:6px; color:var(--accent); text-decoration:none; font-size:0.9rem; font-weight:600; transition:transform 0.2s, opacity 0.2s; padding:6px 12px; border-radius:8px; background:rgba(255,255,255,0.5);" onmouseover="this.style.opacity='0.8'; this.style.transform='translateY(-1px)'" onmouseout="this.style.opacity='1'; this.style.transform='translateY(0)'">
          <span>ØªÙ„ÙŠÙ‚Ø±Ø§Ù…</span>
        </a>
        <a href="https://www.snapchat.com/@iahmad_soliman" target="_blank" rel="noopener noreferrer" style="display:inline-flex; align-items:center; gap:6px; color:var(--accent); text-decoration:none; font-size:0.9rem; font-weight:600; transition:transform 0.2s, opacity 0.2s; padding:6px 12px; border-radius:8px; background:rgba(255,255,255,0.5);" onmouseover="this.style.opacity='0.8'; this.style.transform='translateY(-1px)'" onmouseout="this.style.opacity='1'; this.style.transform='translateY(0)'">
          <span>Ø³Ù†Ø§Ø¨</span>
        </a>
      </div>
    </footer>
  </main>

  <script>
    const coffeeInput = document.getElementById('coffee');
    const ratioSelect = document.getElementById('ratio');
    const customWrapper = document.getElementById('custom-wrapper');
    const customRatioInput = document.getElementById('customRatio');
    const totalWaterEl = document.getElementById('totalWater');
    const summaryEl = document.getElementById('summary');
    const poursEl = document.getElementById('pours');
    const ratioInfoEl = document.getElementById('ratioInfo');
    const coldLineEl = document.getElementById('coldLine');
    const stepButtons = Array.from(document.querySelectorAll('.input-step'));
    const modeChips = Array.from(document.querySelectorAll('.mode-chip'));
    const fixChoices = document.getElementById('fixChoices');
    const fixStepBox = document.getElementById('fixStepBox');
    const fixStepTitle = document.getElementById('fixStepTitle');
    const fixStepText = document.getElementById('fixStepText');
    const fixNextBtn = document.getElementById('fixNext');
    const fixResetBtn = document.getElementById('fixReset');
    let currentMode = 'hot'; // Ø­Ø§Ø± Ø£Ùˆ Ø¨Ø§Ø±Ø¯
    let currentIssue = null;
    let currentIssueIndex = 0;

    const troubleshooting = {
      bitter: {
        title: 'Ù…Ø±Ø§Ø±Ø© Ø¹Ø§Ù„ÙŠØ©',
        steps: [
          'Ù‚Ù„Ù‘Ù„ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ø¡ Ø´ÙˆÙŠ (Ù…Ø«Ø§Ù„: Ù…Ù† 92Â° Ø¥Ù„Ù‰ 89-90Â°).',
          'Ù„Ø³Ø§ Ù…ÙØ±Ø©ØŸ Ø®Ø´Ù† Ø§Ù„Ø·Ø­Ù†Ø© Ø´ÙˆÙŠ ÙˆØ¬Ø±Ù‘Ø¨ Ù†ÙØ³ Ø§Ù„ÙˆØµÙØ©.',
          'Ù„Ø³Ù‘Ø§ Ù…Ø²Ø¹Ø¬Ø©ØŸ ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù‚Ù‡ÙˆØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„ØªØ±Ø´ÙŠØ­Ø› Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ Ø§Ù„ØºØ§Ù…Ù‚Ø© Ø£Ùˆ Ø§Ù„Ø¨Ù„Ù†Ø¯ ØºÙŠØ± Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„ÙÙ„ØªØ± ØºØ§Ù„Ø¨Ø§Ù‹ ØªØ¹Ø·ÙŠ Ù…Ø±Ø§Ø±Ø© Ø£Ø¹Ù„Ù‰.'
        ]
      },
      acidic: {
        title: 'Ø­Ù…Ø¶ÙŠØ© Ø¹Ø§Ù„ÙŠØ©',
        steps: [
          'Ø²ÙØ¯ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ø¡ (Ù…Ø«Ø§Ù„: Ù…Ù† 89Â° Ø¥Ù„Ù‰ 90â€“92Â°).',
          'Ù„Ø³Ù‡ Ø­Ù…Ø¶ÙŠØªÙ‡Ø§ Ø¹Ø§Ù„ÙŠØ©ØŸ Ù†Ø¹Ù‘Ù… Ø§Ù„Ø·Ø­Ù†Ø© Ø´ÙˆÙŠ ÙˆØ¬Ø±Ø¨ Ù†ÙØ³ Ø§Ù„ÙˆØµÙØ©.',
          'Ø¥Ø°Ø§ Ù…Ø§ Ø²Ø¨Ø·Øª Ù…Ø¹ÙƒØ› Ù…Ù…ÙƒÙ† Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ØµÙˆÙ„ Ù…Ø§ ÙŠÙ†Ø§Ø³Ø¨ Ø°Ø§Ø¦Ù‚ØªÙƒ ÙˆÙ‡Ø°Ø§ Ø·Ø¨ÙŠØ¹ÙŠ Ø®ØµÙˆØµØ§Ù‹ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ù…ØºØ³ÙˆÙ„Ø© Ù…Ø«Ù„Ù‹Ø§ØŒ Ø¬Ø±Ø¨ Ø§Ù„Ø£Ø«ÙŠÙˆØ¨ÙŠØ§Øª Ø¨Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø¬ÙÙØ©.'
        ]
      },
      cold: {
        title: 'Ø§Ù„ÙƒÙˆØ¨ Ø¨Ø§Ø±Ø¯',
        steps: [
          'Ø³Ø®Ù‘Ù† Ø§Ù„Ù‚Ù…Ø¹ ÙˆØ§Ù„Ø³ÙŠØ±ÙØ± ÙˆØ§Ù„ÙƒÙˆØ¨ Ù‚Ø¨Ù„ Ù…Ø§ ØªØ¨Ø¯Ø£ Ø§Ù„ØªØ±Ø´ÙŠØ­.',
          'ØªØ£ÙƒØ¯ Ø£Ù† ÙƒÙ„ Ø£Ø¯ÙˆØ§ØªÙƒ Ø¯Ø§ÙØ¦Ø© Ù‚Ø¨Ù„ Ù…Ø§ ØªØµØ¨ Ø§Ù„Ù‚Ù‡ÙˆØ©Ø› Ø§Ù„Ø¨Ø±ÙˆØ¯Ø© ØªØ³Ø­Ø¨ Ø­Ø±Ø§Ø±Ø© Ø§Ù„ÙƒÙˆØ¨ ÙˆØªØ®ÙÙ Ø§Ù„Ù†ÙƒÙ‡Ø§Øª.'
        ]
      },
      thin: {
        title: 'Ø§Ù„Ù‚ÙˆØ§Ù… Ø®ÙÙŠÙ',
        steps: [
          'ØªØ£ÙƒØ¯ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‚Ù‡ÙˆØ©ØŒ Ø§Ù„Ù‚Ù‡ÙˆØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ØªÙÙ‚Ø¯ Ø§Ù„Ù†ÙƒÙ‡Ø© ÙˆØ§Ù„Ù‚ÙˆØ§Ù….',
          'ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø·Ø­Ù†Ø© Ø·Ø§Ø²Ø¬Ø© ÙˆÙ…Ø§ Ø¬Ù„Ø³Øª Ù…Ø·Ø­ÙˆÙ†Ø© ÙØªØ±Ø© Ø·ÙˆÙŠÙ„Ø©.',
          'ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø­ÙƒØ§Ù… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙƒÙŠØ³ Ø¨ÙŠÙ† ÙƒÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù….',
          'Ø¨Ø§Ù‚ÙŠ Ø®ÙÙŠÙØ©ØŸ Ù‚Ù„Ù‘Ù„ Ø§Ù„Ø±ÙŠØ´ÙŠÙˆ Ø´ÙˆÙŠØŒ Ø¬Ø±Ù‘Ø¨ Ù…Ø«Ù„Ø§Ù‹ 1/14.'
        ]
      },
      burnt: {
        title: 'Ø·Ø¹Ù… Ø­Ø±Ù‚',
        steps: [
          'Ù„Ø§ ØªØªØ­Ù…Ø³ ÙˆØªØ±Ø´Ù‘Ø­ Ø¨Ø¯Ø±Ø¬Ø© Ø§Ù„ØºÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø´Ø±Ø© (ØªØµÙŠØ± Ù„Ùˆ Ù…Ø§ Ø¹Ù†Ø¯Ùƒ ØºÙ„Ø§ÙŠØ© Ù…Ø®ØµØµØ© Ù„Ù„ØªØ±Ø´ÙŠØ­ØŒ Ø§ØµØ¨Ø± Ø´ÙˆÙŠØ§Øª Ø¨Ø¹Ø¯ Ù…Ø§ ØªØºÙ„ÙŠ Ø§Ù„Ù…ÙˆÙŠØ©)',
          'ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù‚Ù‡ÙˆØ© Ù…Ø®ØµØµØ© Ù„Ù„ØªØ±Ø´ÙŠØ­ØŒ Ù…Ùˆ Ù…ÙˆØ¬Ù‡Ø© Ù„Ù„Ø£Ø³Ø¨Ø±ÙŠØ³Ùˆ Ø£Ùˆ Ø­Ù…ØµØªÙ‡Ø§ ØºØ§Ù…Ù‚Ø© Ø¨Ø²ÙŠØ§Ø¯Ø©.'
        ]
      }
    };

    function format(number) {
      return Number.isFinite(number) ? number.toFixed(0) : '--';
    }

    function calculate() {
      const coffee = parseFloat(coffeeInput.value);
      let ratio;

      if (ratioSelect.value === 'custom') {
        ratio = customRatioInput ? parseFloat(customRatioInput.value) : NaN;
      } else {
        ratio = parseFloat(ratioSelect.value);
      }

      // ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ø§Ø±Ø¯ Ù†Ø¶Ù…Ù† Ø£Ù„Ø§ ÙŠÙ‚Ù„ Ø§Ù„Ø±ÙŠØ´ÙŠÙˆ Ø¹Ù† 7
      if (currentMode === 'cold' && ratio < 7) {
        ratio = 7;
        if (ratioSelect.value === 'custom') {
          customRatioInput.value = ratio;
        } else {
          ratioSelect.value = '7';
        }
      }

      if (!coffee || coffee <= 0 || !ratio || ratio <= 0) {
        totalWaterEl.textContent = '-- Ù…Ù„';
        summaryEl.textContent = '';
        poursEl.innerHTML = '';
        ratioInfoEl.textContent = '';
        coldLineEl.style.display = 'none';
        coldLineEl.textContent = '';
        return;
      }

      const modeLabel = currentMode === 'cold' ? 'Ø¨Ø§Ø±Ø¯Ø©' : 'Ø­Ø§Ø±Ø©';
      const baseTotal = coffee * ratio; // Ù†ÙØ³ Ø§Ù„Ø­Ø§Ø±Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹
      const totalWater = baseTotal;

      totalWaterEl.textContent = `${format(totalWater)} Ù…Ù„`;
      summaryEl.textContent = ""; // Ø¥Ø®ÙØ§Ø¡ Ø³Ø·Ø± "Ù‚Ù‡ÙˆØ© 20 Ø¬Ø±Ø§Ù… â€¢ Ø±ÙŠØ´ÙŠÙˆ ..."
      if (currentMode === 'cold') {
        ratioInfoEl.innerHTML =
          `<strong style="font-size:0.86rem;">(Ù†ØµÙ Ø§Ù„ÙƒÙ…ÙŠØ© Ù‚Ù‡ÙˆØ©ØŒ ÙˆÙ†ØµÙÙ‡Ø§ Ø«Ù„Ø¬)</strong>`;
      } else {
        ratioInfoEl.innerHTML =
          `ÙƒÙ„ Ù¡ Ø¬Ø±Ø§Ù… Ø¨Ù† â‰ˆ ${ratio.toFixed(1)} Ù…Ù„ Ù…Ø§Ø¡` +
          `<br><strong style="font-size:0.86rem;">(Ø®Ù„Ùƒ Ø£ÙØ¶Ù„ Ø¹Ù„Ù‰ 1/15)</strong>`;
      }

      if (currentMode === 'hot') {
        const bloom = coffee * 2 + 10; // ØªØ±Ø·ÙŠØ¨ = Ø¶Ø¹Ù Ø§Ù„Ø¨Ù† + Ù¡Ù  Ù…Ù„
        const remaining = totalWater - bloom;
        const eachPour = remaining / 4;

        // ÙƒÙ…ÙŠØ§Øª ÙˆØªØ±Ø§ÙƒÙ… Ø¨Ø¹Ø¯ ÙƒÙ„ ØµØ¨Ø©
        const totals = [
          bloom,
          bloom + eachPour,
          bloom + eachPour * 2,
          bloom + eachPour * 3,
          totalWater,
        ];

        const pours = [
          { label: 'Ø§Ù„ØªØ±Ø·ÙŠØ¨', amount: bloom, total: totals[0] },
          { label: 'Ø§Ù„ØµØ¨Ø© Ù¢', amount: eachPour, total: totals[1] },
          { label: 'Ø§Ù„ØµØ¨Ø© Ù£', amount: eachPour, total: totals[2] },
          { label: 'Ø§Ù„ØµØ¨Ø© Ù¤', amount: eachPour, total: totals[3] },
          { label: 'Ø§Ù„ØµØ¨Ø© Ù¥', amount: eachPour, total: totals[4] },
        ];

        poursEl.innerHTML = pours
          .map(
            (p) => `
              <div class="pour">
                <div>
                  <strong>${p.label}</strong>
                  <div class="muted" style="font-size:0.82rem;margin-top:2px;">
                    Ù…Ù‚Ø¯Ø§Ø± Ø§Ù„ØµØ¨Ø©: ${format(p.amount)} Ù…Ù„
                  </div>
                </div>
                <span><span class="pour-label">ØµØ¨ Ø¥Ù„Ù‰:</span> <span class="pour-number">${format(p.total)} Ù…Ù„</span></span>
              </div>`
          )
          .join('');

        coldLineEl.style.display = 'none';
        coldLineEl.textContent = '';
      } else {
        // Ø§Ù„Ù‚Ù‡ÙˆØ© Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©: Ù†ÙØ³ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØŒ Ù„ÙƒÙ† Ù†ØµÙÙ‡ Ù…Ø§Ø¡ ÙŠÙ…Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù† ÙˆÙ†ØµÙÙ‡ Ø«Ù„Ø¬ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±
        const coldTotal = baseTotal;
        const coldWater = coldTotal / 2;
        const coldIce = coldTotal - coldWater; // Ù„Ø¶Ø¨Ø· Ø§Ù„ØªÙ‚Ø±ÙŠØ¨

        const bloomCold = Math.min(coldWater, coffee * 2 + 10);
        const remainingCold = coldWater - bloomCold;
        const eachPourCold = remainingCold / 4;

        const totalsCold = [
          bloomCold,
          bloomCold + eachPourCold,
          bloomCold + eachPourCold * 2,
          bloomCold + eachPourCold * 3,
          coldWater,
        ];

        const coldPours = [
          { label: 'Ø§Ù„ØªØ±Ø·ÙŠØ¨', amount: bloomCold, total: totalsCold[0] },
          { label: 'Ø§Ù„ØµØ¨Ø© Ù¢', amount: eachPourCold, total: totalsCold[1] },
          { label: 'Ø§Ù„ØµØ¨Ø© Ù£', amount: eachPourCold, total: totalsCold[2] },
          { label: 'Ø§Ù„ØµØ¨Ø© Ù¤', amount: eachPourCold, total: totalsCold[3] },
          { label: 'Ø§Ù„ØµØ¨Ø© Ù¥', amount: eachPourCold, total: totalsCold[4] },
        ];

        poursEl.innerHTML = coldPours
          .map(
            (p) => `
              <div class="pour">
                <div>
                  <strong>${p.label}</strong>
                  <div class="muted" style="font-size:0.82rem;margin-top:2px;">
                    Ù…Ù‚Ø¯Ø§Ø± Ø§Ù„ØµØ¨Ø© (Ù…Ø§Ø¡): ${format(p.amount)} Ù…Ù„
                  </div>
                </div>
                <span><span class="pour-label">ØµØ¨ Ø¥Ù„Ù‰:</span> <span class="pour-number">${format(p.total)} Ù…Ù„</span></span>
              </div>`
          )
          .join('');

        coldLineEl.style.display = 'block';
        coldLineEl.innerHTML = `<strong:</strong> Ø¥Ø¬Ù…Ø§Ù„ÙŠ ${format(coldTotal)} Ù…Ù„ : ØªØ±Ø´ÙŠØ­ ${format(coldWater)} Ù…Ù„ + <strong>Ø«Ù„Ø¬ ${format(coldIce)} Ù…Ù„ </strong>ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±.`;
      }

      // Ø­Ø±ÙƒØ© Ø®ÙÙŠÙØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«
      totalWaterEl.classList.remove('bump');
      void totalWaterEl.offsetWidth; // reflow Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
      totalWaterEl.classList.add('bump');
    }

    stepButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const step = parseInt(btn.dataset.step, 10) || 1;
        let current = parseFloat(coffeeInput.value) || 0;
        current = Math.max(1, current + step);
        coffeeInput.value = current;
        calculate();
      });
    });

    modeChips.forEach((chip) => {
      chip.addEventListener('click', () => {
        const mode = chip.dataset.mode;
        if (!mode) return;
        if (mode === currentMode) return;

        modeChips.forEach((c) => c.classList.toggle('active', c === chip));
        currentMode = mode;
        document.body.classList.toggle('cold-mode', currentMode === 'cold');
        calculate();
      });
    });

    ratioSelect.addEventListener('change', () => {
      const isCustom = ratioSelect.value === 'custom';
      if (customWrapper) {
        customWrapper.style.display = isCustom ? 'block' : 'none';
      }
      // Ù„Ùˆ Ø§Ø®ØªØ§Ø± Ù…Ø®ØµØµ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø© Ù†Ø®Ù„ÙŠ ÙÙŠÙ‡ Ù‚ÙŠÙ…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ùˆ ÙƒØ§Ù† ÙØ§Ø¶ÙŠ
      if (isCustom && customRatioInput && !customRatioInput.value) {
        customRatioInput.value = ratioSelect.options[ratioSelect.selectedIndex]?.value || '15';
      }
      calculate();
    });

    [coffeeInput, customRatioInput].forEach((el) => {
      if (!el) return;
      el.addEventListener('input', calculate);
    });

    // ØªÙØ§Ø¹Ù„ "Ø¹Ø§Ù„Ø¬ ÙƒÙˆØ¨Ùƒ"
    if (fixChoices) {
      Array.from(fixChoices.querySelectorAll('.fix-chip')).forEach((chip) => {
        chip.addEventListener('click', () => {
          const issueKey = chip.dataset.issue;
          if (!issueKey || !troubleshooting[issueKey]) return;

          currentIssue = issueKey;
          currentIssueIndex = 0;

          Array.from(fixChoices.querySelectorAll('.fix-chip')).forEach((c) =>
            c.classList.toggle('active', c === chip)
          );

          const issue = troubleshooting[issueKey];
          fixStepTitle.textContent = issue.title;
          fixStepText.textContent = issue.steps[0];
          fixStepBox.style.display = 'block';

          // Ù„Ùˆ Ø®Ø·ÙˆØ© ÙˆØ­Ø¯Ø© ÙÙ‚Ø· Ù†Ø®ÙÙŠ Ø²Ø± "Ù…Ø§ Ø²Ø¨Ø·ØªØŸ"
          fixNextBtn.style.display = issue.steps.length > 1 ? 'inline-block' : 'none';
        });
      });
    }

    if (fixNextBtn) {
      fixNextBtn.addEventListener('click', () => {
        if (!currentIssue || !troubleshooting[currentIssue]) return;
        const issue = troubleshooting[currentIssue];
        if (currentIssueIndex < issue.steps.length - 1) {
          currentIssueIndex += 1;
          fixStepText.textContent = issue.steps[currentIssueIndex];
        }
        if (currentIssueIndex >= issue.steps.length - 1) {
          fixNextBtn.style.display = 'none';
        }
      });
    }

    if (fixResetBtn) {
      fixResetBtn.addEventListener('click', () => {
        currentIssue = null;
        currentIssueIndex = 0;
        fixStepBox.style.display = 'none';
        if (fixChoices) {
          Array.from(fixChoices.querySelectorAll('.fix-chip')).forEach((c) =>
            c.classList.remove('active')
          );
        }
      });
    }

    // Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø³Ù… Ø§Ù„Ø·Ø­Ù†Ø©
    const coffeeTypeSelect = document.getElementById('coffeeType');
    const grindResult = document.getElementById('grindResult');
    const grindLevel = document.getElementById('grindLevel');

    const grindLevels = {
      fine: { // Ù†Ø§Ø¹Ù…Ø©
        types: ['sumatra', 'salvador', 'honduras'],
        text: 'Ù†Ø§Ø¹Ù…Ø©',
        emoji: ''
      },
      medium: { // Ù…ØªÙˆØ³Ø·Ø©
        types: ['colombia', 'mexico', 'guatemala', 'costa-rica', 'nicaragua', 'panama', 'peru'],
        text: 'Ù…ØªÙˆØ³Ø·Ø©',
        emoji: ''
      },
      coarse: { // Ø®Ø´Ù†Ø© Ù‚Ù„ÙŠÙ„Ø§Ù‹
        types: ['ethiopia', 'yemen', 'rwanda', 'uganda', 'burundi', 'brazil'],
        text: 'Ø®Ø´Ù†Ø© Ù‚Ù„ÙŠÙ„Ø§Ù‹',
        emoji: ''
      },
      extraCoarse: { // Ø®Ø´Ù†Ø© Ø¨Ø²ÙŠØ§Ø¯Ø©
        types: ['kenya'],
        text: 'Ø®Ø´Ù†Ø© Ø¨Ø²ÙŠØ§Ø¯Ø©',
        emoji: ''
      }
    };

    if (coffeeTypeSelect) {
      coffeeTypeSelect.addEventListener('change', () => {
        const selectedType = coffeeTypeSelect.value;
        
        if (!selectedType) {
          grindResult.style.display = 'none';
          return;
        }

        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù†ÙˆØ¹ Ø§Ù„Ø·Ø­Ù†Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
        let foundLevel = null;
        for (const [levelKey, levelData] of Object.entries(grindLevels)) {
          if (levelData.types.includes(selectedType)) {
            foundLevel = levelData;
            break;
          }
        }

        if (foundLevel) {
          grindLevel.textContent = `${foundLevel.emoji} ${foundLevel.text}`;
          grindResult.style.display = 'block';
          
          // Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© Ø®ÙÙŠÙØ©
          grindResult.style.opacity = '0';
          grindResult.style.transform = 'translateY(-4px)';
          setTimeout(() => {
            grindResult.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            grindResult.style.opacity = '1';
            grindResult.style.transform = 'translateY(0)';
          }, 10);
        } else {
          grindResult.style.display = 'none';
        }
      });
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ø§Ø±Ø¯
    const updateGrindResultColors = () => {
      if (currentMode === 'cold') {
        grindResult.style.background = 'linear-gradient(145deg, rgba(219,234,254,0.6), rgba(191,219,254,0.4))';
        grindResult.style.borderColor = 'rgba(37,99,235,0.3)';
      } else {
        grindResult.style.background = 'linear-gradient(145deg, rgba(247,230,209,0.6), rgba(242,201,161,0.4))';
        grindResult.style.borderColor = 'rgba(196,128,75,0.3)';
      }
    };

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ¶Ø¹
    modeChips.forEach((chip) => {
      chip.addEventListener('click', () => {
        setTimeout(updateGrindResultColors, 100);
      });
    });

    // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¤Ù‚Øª
    const timerDisplay = document.getElementById('timerDisplay');
    const timerTimeText = document.getElementById('timerTimeText');
    const timerBtn = document.getElementById('timerBtn');
    let timerInterval = null;
    let timerSeconds = 0;
    let timerMaxSeconds = 0; // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ÙˆÙ‚Øª

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    }

    function updateTimerDisplay() {
      if (!timerTimeText) return;
      
      // Ø§Ù„Ù…Ø¤Ù‚Øª ØªØµØ§Ø¹Ø¯ÙŠ ÙÙ‚Ø·: ÙŠØ¹Ø±Ø¶ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ù‚Ø¶ÙŠ
      timerTimeText.textContent = formatTime(timerSeconds);
      
      if (timerInterval) {
        timerDisplay.classList.add('running');
        timerDisplay.classList.remove('finished');
      } else {
        timerDisplay.classList.remove('running');
        timerDisplay.classList.remove('finished');
      }
    }

    let timerPaused = false; // Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¤Ù‚Øª: false = Ø´ØºØ§Ù„ØŒ true = Ù…ØªÙˆÙ‚Ù

    function startTimer() {
      // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØªØµØ§Ø¹Ø¯ÙŠ ÙŠØ¨Ø¯Ø£ Ù…Ù† 00:00 Ø¨Ø¯ÙˆÙ† Ø­Ø¯ Ø£Ù‚ØµÙ‰
      timerMaxSeconds = 0; // Ø¨Ø¯ÙˆÙ† Ø­Ø¯ Ø£Ù‚ØµÙ‰
      
      updateTimerDisplay();

      timerBtn.textContent = 'Ø¥ÙŠÙ‚Ø§Ù';
      timerBtn.classList.add('stop');
      timerPaused = false;

      if (timerResetBtn) {
        timerResetBtn.textContent = 'Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª';
        timerResetBtn.classList.remove('resume');
      }

      timerInterval = setInterval(() => {
        // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØªØµØ§Ø¹Ø¯ÙŠ: ÙŠØ¨Ø¯Ø£ Ù…Ù† 0 ÙˆÙŠØ±ØªÙØ¹ Ø¨Ø¯ÙˆÙ† Ø­Ø¯
        timerSeconds++;
        updateTimerDisplay();
      }, 1000);
    }

    function pauseTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      timerPaused = true;
      if (timerResetBtn) {
        timerResetBtn.textContent = 'Ø§Ø³ØªÙ…Ø±Ø§Ø±';
        timerResetBtn.classList.add('resume');
      }
    }

    function resumeTimer() {
      timerPaused = false;
      timerBtn.textContent = 'Ø¥ÙŠÙ‚Ø§Ù';
      timerBtn.classList.add('stop');
      if (timerResetBtn) {
        timerResetBtn.textContent = 'Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª';
        timerResetBtn.classList.remove('resume');
      }

      timerInterval = setInterval(() => {
        timerSeconds++;
        updateTimerDisplay();
      }, 1000);
    }

    function resetTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      timerSeconds = 0;
      timerPaused = false;
      updateTimerDisplay();
      timerBtn.textContent = 'Ø§Ø¨Ø¯Ø£';
      timerBtn.classList.remove('stop');
      if (timerResetBtn) {
        timerResetBtn.textContent = 'Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª';
        timerResetBtn.classList.remove('resume');
      }
    }

    if (timerBtn) {
      timerBtn.addEventListener('click', () => {
        if (timerInterval) {
          // Ø§Ù„Ù…Ø¤Ù‚Øª Ø´ØºØ§Ù„: Ø¥ÙŠÙ‚Ø§ÙÙ‡ ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†"
          pauseTimer();
          timerBtn.textContent = 'Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†';
          timerBtn.classList.remove('stop');
        } else if (timerPaused) {
          // Ø§Ù„Ù…Ø¤Ù‚Øª Ù…ØªÙˆÙ‚Ù: Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† (ØªØµÙÙŠØ±)
          resetTimer();
        } else {
          // Ø§Ù„Ù…Ø¤Ù‚Øª ØµÙØ±: Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
          startTimer();
        }
      });
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙˆÙ„ÙŠ
    if (timerDisplay) {
      timerSeconds = 0;
      timerMaxSeconds = 0;
      updateTimerDisplay();
    }

    // Ø²Ø± Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª
    const timerResetBtn = document.getElementById('timerResetBtn');
    if (timerResetBtn) {
      timerResetBtn.addEventListener('click', () => {
        if (timerInterval) {
          // Ø§Ù„Ù…Ø¤Ù‚Øª Ø´ØºØ§Ù„: Ø¥ÙŠÙ‚Ø§ÙÙ‡ ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ "Ø§Ø³ØªÙ…Ø±Ø§Ø±"
          pauseTimer();
        } else if (timerPaused) {
          // Ø§Ù„Ù…Ø¤Ù‚Øª Ù…ØªÙˆÙ‚Ù: Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù…Ù† Ø­ÙŠØ« ØªÙˆÙ‚Ù
          resumeTimer();
        }
      });
    }

    // Ø¥Ø¯Ø§Ø±Ø© ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ²
    const focusModeBtn = document.getElementById('focusModeBtn');
    const focusOverlay = document.getElementById('focusOverlay');
    const focusCloseBtn = document.getElementById('focusCloseBtn');
    const focusContent = document.getElementById('focusContent');

    function openFocusMode() {
      if (!focusContent) return;
      
      // Ù†Ø³Ø® Ø§Ù„ØµØ¨Ø§Øª ÙˆØ§Ù„Ù…Ø¤Ù‚Øª
      const outputCard = document.querySelector('.output-card');
      const timerContainer = document.querySelector('.timer-container');
      
      if (!outputCard || !timerContainer) return;
      
      focusContent.innerHTML = '';
      
      // Ù†Ø³Ø® Ø§Ù„ØµØ¨Ø§Øª
      const poursClone = document.getElementById('pours').cloneNode(true);
      const instructionDiv = document.querySelector('.output-card > div[style*="border-top"]');
      const instructionClone = instructionDiv ? instructionDiv.cloneNode(true) : null;
      
      // Ù†Ø³Ø® Ø§Ù„Ù…Ø¤Ù‚Øª
      const timerClone = timerContainer.cloneNode(true);
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù€ popup
      const focusOutputCard = outputCard.cloneNode(false);
      focusOutputCard.innerHTML = '';
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
      const badge = document.createElement('span');
      badge.className = 'badge';
      badge.textContent = 'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ';
      focusOutputCard.appendChild(badge);
      
      const total = document.createElement('div');
      total.className = 'total';
      total.id = 'focusTotalWater';
      total.textContent = document.getElementById('totalWater').textContent;
      focusOutputCard.appendChild(total);
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµØ¨Ø§Øª
      focusOutputCard.appendChild(poursClone);
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
      if (instructionClone) {
        focusOutputCard.appendChild(instructionClone);
      }
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¤Ù‚Øª
      focusOutputCard.appendChild(timerClone);
      
      focusContent.appendChild(focusOutputCard);
      
      // Ø±Ø¨Ø· Ø§Ù„Ù…Ø¤Ù‚Øª ÙÙŠ Ø§Ù„Ù€ popup
      const focusTimerBtn = timerClone.querySelector('#timerBtn');
      const focusTimerResetBtn = timerClone.querySelector('#timerResetBtn');
      const focusTimerTimeText = timerClone.querySelector('#timerTimeText');
      const focusTimerDisplay = timerClone.querySelector('.timer-display');
      
      if (focusTimerBtn && focusTimerTimeText) {
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ù‚Øª ÙÙŠ Ø§Ù„Ù€ popup
        const updateFocusTimer = () => {
          const originalTimeText = document.querySelector('#timerTimeText');
          const originalBtn = document.getElementById('timerBtn');
          const originalResetBtn = document.getElementById('timerResetBtn');
          const originalDisplay = document.querySelector('.timer-display');
          
          if (originalTimeText) {
            focusTimerTimeText.textContent = originalTimeText.textContent;
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
            focusTimerBtn.textContent = originalBtn.textContent;
            if (originalBtn.classList.contains('stop')) {
              focusTimerBtn.classList.add('stop');
            } else {
              focusTimerBtn.classList.remove('stop');
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø²Ø± Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª
            if (focusTimerResetBtn && originalResetBtn) {
              focusTimerResetBtn.textContent = originalResetBtn.textContent;
              if (originalResetBtn.classList.contains('resume')) {
                focusTimerResetBtn.classList.add('resume');
              } else {
                focusTimerResetBtn.classList.remove('resume');
              }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù€ display
            if (originalDisplay) {
              focusTimerDisplay.classList.remove('running', 'finished');
              if (originalDisplay.classList.contains('running')) {
                focusTimerDisplay.classList.add('running');
              }
              if (originalDisplay.classList.contains('finished')) {
                focusTimerDisplay.classList.add('finished');
              }
            }
          }
        };
        
        updateFocusTimer();
        
        // ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªÙ…Ø± Ù„Ù„Ù…Ø¤Ù‚Øª
        const focusTimerUpdateInterval = setInterval(() => {
          if (focusOverlay.classList.contains('active')) {
            updateFocusTimer();
          } else {
            clearInterval(focusTimerUpdateInterval);
          }
        }, 100);
        
        // Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø« - Ø§Ø³ØªØ®Ø¯Ø§Ù… mousedown Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† click Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
        focusTimerBtn.addEventListener('mousedown', (e) => {
          e.preventDefault();
          e.stopPropagation();
        });
        
        focusTimerBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          
          // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
          if (timerInterval) {
            pauseTimer();
            timerBtn.textContent = 'Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†';
            timerBtn.classList.remove('stop');
          } else if (timerPaused) {
            resetTimer();
          } else {
            startTimer();
          }
          
          // ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ ÙˆÙ…Ø³ØªÙ…Ø±
          updateFocusTimer();
          setTimeout(updateFocusTimer, 100);
          setTimeout(updateFocusTimer, 300);
        });
        
        // Ø£ÙŠØ¶Ø§Ù‹ Ø¥Ø¶Ø§ÙØ© touchstart Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù„Ù…Ø³ÙŠØ©
        focusTimerBtn.addEventListener('touchstart', (e) => {
          e.preventDefault();
          e.stopPropagation();
          
          // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
          if (timerInterval) {
            pauseTimer();
            timerBtn.textContent = 'Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†';
            timerBtn.classList.remove('stop');
          } else if (timerPaused) {
            resetTimer();
          } else {
            startTimer();
          }
          
          // ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ ÙˆÙ…Ø³ØªÙ…Ø±
          updateFocusTimer();
          setTimeout(updateFocusTimer, 100);
          setTimeout(updateFocusTimer, 300);
        });
        
        // Ø²Ø± Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ²
        if (focusTimerResetBtn) {
          focusTimerResetBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            
            if (timerInterval) {
              pauseTimer();
              if (timerResetBtn) {
                timerResetBtn.textContent = 'Ø§Ø³ØªÙ…Ø±Ø§Ø±';
                timerResetBtn.classList.add('resume');
              }
            } else if (timerPaused) {
              resumeTimer();
            }
            
            setTimeout(updateFocusTimer, 100);
          });
        }
      }
      
      focusOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeFocusMode() {
      if (focusOverlay) {
        focusOverlay.classList.remove('active');
        document.body.style.overflow = '';
      }
    }

    if (focusModeBtn) {
      focusModeBtn.addEventListener('click', openFocusMode);
    }

    if (focusCloseBtn) {
      focusCloseBtn.addEventListener('click', closeFocusMode);
    }

    if (focusOverlay) {
      focusOverlay.addEventListener('click', (e) => {
        if (e.target === focusOverlay) {
          closeFocusMode();
        }
      });
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙÙŠ Ø§Ù„Ù€ popup Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„ØµØ¨Ø§Øª
    const originalCalculate = calculate;
    calculate = function() {
      originalCalculate();
      if (focusOverlay && focusOverlay.classList.contains('active')) {
        const focusTotal = document.getElementById('focusTotalWater');
        if (focusTotal) {
          focusTotal.textContent = document.getElementById('totalWater').textContent;
        }
        const focusPours = focusContent.querySelector('#pours');
        if (focusPours) {
          focusPours.innerHTML = document.getElementById('pours').innerHTML;
        }
      }
    };

    calculate();

    // Dark Mode Toggle
    const darkModeToggle = document.getElementById('darkModeToggle');
    const darkModeIcon = document.getElementById('darkModeIcon');
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ¶ÙŠÙ„ Ø§Ù„Ù…Ø­ÙÙˆØ¸
    const savedDarkMode = localStorage.getItem('darkMode') === 'true';
    if (savedDarkMode) {
      document.body.classList.add('dark-mode');
      darkModeIcon.textContent = 'â˜€ï¸';
    } else {
      darkModeIcon.textContent = 'ğŸŒ™';
    }
    
    // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙˆØ¶Ø¹ÙŠÙ†
    darkModeToggle.addEventListener('click', () => {
      const isDark = document.body.classList.toggle('dark-mode');
      darkModeIcon.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
      localStorage.setItem('darkMode', isDark);
    });
  </script>
</body>
</html>

